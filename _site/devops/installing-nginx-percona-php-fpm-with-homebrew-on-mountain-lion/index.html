<!DOCTYPE html>
<html lang="en-US" itemscope itemtype="http://schema.org/Article">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Installing nginx/percona/php-fpm with homebrew on Mountain Lion - Shane Logsdon</title>
    <meta name="description" content="If it helps anyone else, that&#39;s an added bonus, but this is mainly just a reference point for me; I&#39;m always forgetting what all needs to be done setting up a development environment going. MNPP doesn&#39;t seem to work well, and I&#39;m too cheap at the moment to pay for for MAMP Pro. Plus, MAMP uses Apache which I&#39;ve been trying to get away from for the past few months because of its slowness.
&hellip;" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Google -->
    <meta itemprop="name" content="Installing nginx/percona/php-fpm with homebrew on Mountain Lion - Shane Logsdon">
    <meta itemprop="description" content="If it helps anyone else, that&#39;s an added bonus, but this is mainly just a reference point for me; I&#39;m always forgetting what all needs to be done setting up a development environment going. MNPP doesn&#39;t seem to work well, and I&#39;m too cheap at the moment to pay for for MAMP Pro. Plus, MAMP uses Apache which I&#39;ve been trying to get away from for the past few months because of its slowness.
&hellip;">
    <!-- <meta itemprop="image" content="http://www.example.com/image.jpg"> -->
    <!-- Facebook -->
    <meta property="og:title" content="Installing nginx/percona/php-fpm with homebrew on Mountain Lion - Shane Logsdon"> 
    <meta property="og:description" content="If it helps anyone else, that&#39;s an added bonus, but this is mainly just a reference point for me; I&#39;m always forgetting what all needs to be done setting up a development environment going. MNPP doesn&#39;t seem to work well, and I&#39;m too cheap at the moment to pay for for MAMP Pro. Plus, MAMP uses Apache which I&#39;ve been trying to get away from for the past few months because of its slowness.
&hellip;"> 
    <meta property="og:type" content="article">
    
        <meta property="og:url" content="http://shane.logsdon.io/devops/installing-nginx-percona-php-fpm-with-homebrew-on-mountain-lion/">
    
    <!-- <meta property="og:image" content="http://www.your-site.com/image.jpg"> -->
    <meta property="og:site_name" content="Installing nginx/percona/php-fpm with homebrew on Mountain Lion - Shane Logsdon&hellip;">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    
        <meta property="twitter:url" content="http://shane.logsdon.io/devops/installing-nginx-percona-php-fpm-with-homebrew-on-mountain-lion/">
    
    <meta name="twitter:title" content="Installing nginx/percona/php-fpm with homebrew on Mountain Lion - Shane Logsdon">
    <meta name="twitter:description" content="If it helps anyone else, that&#39;s an added bonus, but this is mainly just a reference point for me; I&#39;m always forgetting what all needs to be done setting up a development environment going. MNPP doesn&#39;t seem to work well, and I&#39;m too cheap at the moment to pay for for MAMP Pro. Plus, MAMP uses Apache which I&#39;ve been trying to get away from for the past few months because of its slowness.
&hellip;">
    <!-- <meta name="twitter:image" content="http://example.com/image.jpg"> -->
    <meta name="author" content="Shane Logsdon">

    <link href="http://shane.logsdon.io/" rel="canonical" />
    <link rel="alternate" type="application/rss+xml" href="http://shane.logsdon.io/feed/atom.xml" title="RSS feed">
    <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <!-- <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png"> -->

    <!-- Custom styles for this template -->
    <link href="/assets/css/main.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- Static navbar -->
    <div class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <img src="http://www.gravatar.com/avatar/033132c341296d7f5e5b41e871178418.png" alt="Shane Logsdon" />
            shane logsdon
          </a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/slogsdon">projects</a></li>
            <li><a href="/archive/">archive</a></li>
            <li><a href="/about/">about</a></li>
            <li><a href="/contact/">contact</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
  
    <div class="white">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2">
        <article id="post" class="full" itemscope itemType="http://schema.org/BlogPosting">
            <meta itemprop="inLanguage" content="en-US"/>
            <h1 itemprop="name">
                <a itemprop="url" href="http://shane.logsdon.io/devops/installing-nginx-percona-php-fpm-with-homebrew-on-mountain-lion/" title="permanent link">Installing nginx/percona/php-fpm with homebrew on Mountain Lion</a>
            </h1>
            <div class="post-details">
                <span>published <time itemprop="datePublished" content="2013-04-14 11:04:00 UTC">14 Apr 2013</time></span>
                <span>in <a href="/categories/devops/">devops</a></span>
            </div>
            
                <div class="post-image">
                    <img src="image.png" />
                </div>
            
            <div class="post" itemprop="articleBody">
                <p>If it helps anyone else, that&#39;s an added bonus, but this is mainly just a reference point for me; I&#39;m always forgetting what all needs to be done setting up a development environment going. <a href="http://getmnpp.org">MNPP</a> doesn&#39;t seem to work well, and I&#39;m too cheap at the moment to pay for for <a href="http://www.mamp.info/en/mamp-pro/">MAMP Pro</a>. Plus, MAMP uses Apache which I&#39;ve been trying to get away from for the past few months because of its slowness.</p>

<h2 id="toc_0">Preparation</h2>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash"><span class="c"># Get Xcode via the App Store and install command-line tools (1.6+GB)</span>

<span class="c"># Grab homebrew</span>
ruby -e <span class="s2">&quot;$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)&quot;</span>

<span class="c"># Grab the taps we&#39;ll need later</span>
brew tap josegonzalez/homebrew-php
brew tap homebrew/dupes
</code></pre></div>
<h2 id="toc_1">Install Percona</h2>

<p>This is a drop-in replacement for MySQL with built-in speed improvements. Double plus good.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">brew install percona-server
brew link percona-server
<span class="nb">unset </span>TMPDIR
mysql_install_db --verbose --user<span class="o">=</span><span class="sb">`</span>whoami<span class="sb">`</span> --basedir<span class="o">=</span><span class="s2">&quot;$(brew --prefix percona-server)&quot;</span> --datadir<span class="o">=</span>/usr/local/var/percona --tmpdir<span class="o">=</span>/tmp
mkdir -p ~/Library/LaunchAgents
cp /usr/local/opt/percona-server/homebrew.mxcl.percona-server.plist ~/Library/LaunchAgents/
launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.percona-server.plist
</code></pre></div>
<h2 id="toc_2">Install nginx</h2>

<p>This little guy&#39;s awesome. No overhead for static files. Can act as a reverse-proxy cache for HTTPS content. I prefer <a href="https://www.varnish-cache.org/">Varnish</a> for HTTP, though.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">brew install nginx
sudo cp <span class="sb">`</span>brew --prefix nginx<span class="sb">`</span>/homebrew.mxcl.nginx.plist /Library/LaunchDaemons/
sudo sed -i -e <span class="s1">&#39;s/`whoami`/root/g&#39;</span> <span class="sb">`</span>brew --prefix nginx<span class="sb">`</span>/homebrew.mxcl.nginx.plist
sudo mkdir /var/log/nginx/
</code></pre></div>
<h2 id="toc_3">Install php-fpm</h2>

<p>PHP&#39;s fastcgi process manager. Kind of a resource hog, but better than using Apache/mod_php.</p>
<div class="highlight"><pre><code class="bash language-bash" data-lang="bash">brew install --without-apache --with-fpm --with-mysql php54
sudo cp <span class="sb">`</span>brew --prefix php54<span class="sb">`</span>/homebrew-php.josegonzalez.php54.plist  /Library/LaunchAgents/
sudo launchctl load -w /Library/LaunchAgents/homebrew-php.josegonzalez.php54.plist
php-fpm -v
sudo mv /usr/sbin/php-fpm /usr/sbin/php-fpm.bak
sudo ln -s /usr/local/Cellar/php54/5.4.11/sbin/php-fpm /usr/sbin/php-fpm
php-fpm -v
php -v
sudo mv /usr/bin/php /usr/bin/php.bak
sudo ln -s /usr/local/bin/php /usr/bin/php
php -v
<span class="nb">echo</span> <span class="s1">&#39;export PATH=$PATH:/usr/local/sbin&#39;</span> &gt;&gt; ~/.zshrc <span class="c"># or ~/.bash_profile</span>
</code></pre></div>
<h5 id="toc_4">Configuration Files</h5>

<ul>
<li>/usr/local/etc/nginx/nginx.conf</li>
<li>/usr/local/etc/php/5.4/php.ini</li>
<li>/usr/local/etc/nginx/fastcgi_params</li>
</ul>

<p>Stop nginx with <code>nginx -s stop</code>, start with <code>nginx</code>, and reload config with <code>nginx -s reload</code>. Homebrew installs under <code>/usr/local</code>, so <code>sudo</code> shouldn&#39;t be needed when issuing those commands.</p>

<p>Percona steps from <a href="http://wizardmode.com/2012/06/apache-php-mysql-dev-on-os-x-lion-with-a-minimum-of-pain/">Wizard Mode</a>. nginx and php-fpm steps from <a href="http://mwholt.blogspot.com/2013/03/install-nginxphpmysql-on-os-x-mountain.html">Matthew Holt</a>.</p>

            </div>
        </article>

        <aside class="signature">
            <hr />
            <div class="engage">
                Have something to add? Comment below, 
                or <a href="mailto:shane@logsdon.io">shoot me an email</a>.
            </div>
            <div class="follow">
                Follow me on <a href="http://twitter.com/shanelogsdon">Twitter</a>
                or subscribe to <a href="/feed/atom.xml">RSS</a>.
            </div>
            <div class="share">
                Share this post on:
                <a class="fa fa-twitter" href="http://twitter.com/share?text=Installing nginx/percona/php-fpm with homebrew on Mountain Lion&url=http://shane.logsdon.io/devops/installing-nginx-percona-php-fpm-with-homebrew-on-mountain-lion/"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="fa fa-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://shane.logsdon.io/devops/installing-nginx-percona-php-fpm-with-homebrew-on-mountain-lion/"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="fa fa-google-plus" href="https://plus.google.com/share?url=http://shane.logsdon.io/devops/installing-nginx-percona-php-fpm-with-homebrew-on-mountain-lion/"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </div>
            <hr />
        </aside>

        <a class="moot"
           href="/i/slogsdon/posts/devops:installing-nginx/percona/php-fpm-with-homebrew-on-mountain-lion"
           data-show_online="true">
           Comments for this blog entry
        </a>
      </div>
    </div>
  </div>
</div>


  
    <!-- +++++ Footer Section +++++ -->
    
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-lg-4 col-md-4 col-sm-4">
            <h4>My Bunker</h4>
            <p>
              Louisville, KY<br/>
              40222<br/>
              United States
            </p>
          </div><!-- /col-lg-4 -->
          
          <div class="col-lg-4 col-md-4 col-sm-4">
            <h4>My Links</h4>
            <p>
              <a href="https://github.com/slogsdon">GitHub</a><br/>
              <a href="https://twitter.com/shanelogsdon">Twitter</a><br/>
              <a href="https://plus.google.com/113806970247389478397?rel=author">Google+</a>
            </p>
          </div><!-- /col-lg-4 -->
          
          <div class="col-lg-4 col-md-4 col-sm-4">
            <h4>About Shane</h4>
            <p>A polyglot web developer. Current interests include Elixir, Go, MVC4, PHP frameworks (Phalcon and Laravel), and DevOps when necessary.</p>
            <p>Works at <a href="http://www.blackstonemedia.com/">Blackstone Media</a> / <a href="http://www.starknine.com/">StarkNine</a> by day.</p>
          </div><!-- /col-lg-4 -->
        
        </div>
      
      </div>
    </footer>
  

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" charset="utf-8"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="//cdn.moot.it/latest/moot.min.js"></script>
    <script>
    (function (window, document, $, undefined) {
      $(document).ready(function () {
        setTimeout(function () {
          $('.m-replyform').addClass('m-focused');
        }, 750);
      });
    })(window, document, jQuery);
    </script>
  </body>
</html>